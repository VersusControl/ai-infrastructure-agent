"use strict";(self.webpackChunkweb_ui_react=self.webpackChunkweb_ui_react||[]).push([[8660],{8660:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(5043),r=a(1686),n=a(6464),c=a(9415),o=a(1894),l=a(9466),u=a(579);const{Text:d}=n.A,i=()=>{const{state:e,dispatch:t}=(0,c.nm)(),[a,n]=(0,s.useState)(null),[i,p]=(0,s.useState)(!1),[y,T]=(0,s.useState)(""),g=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p(!0),t({type:c.TH.SET_LOADING,payload:{key:"state",value:!0}});try{const a=await o.A.getInfrastructureState(e);n(a),t({type:c.TH.SET_INFRASTRUCTURE_STATE,payload:a})}catch(a){console.error("Failed to load infrastructure state:",a)}finally{p(!1),t({type:c.TH.SET_LOADING,payload:{key:"state",value:!1}})}},[t]),f=(0,s.useCallback)(e=>{switch(console.log("InfrastructureStatePage: Handling WebSocket message:",e.type,e),e.type){case"state_update":n(e.data),t({type:c.TH.SET_INFRASTRUCTURE_STATE,payload:e.data});break;case"processing_completed":e.success&&setTimeout(()=>{g(!1)},1e3)}},[t,g]);(0,s.useEffect)(()=>(t({type:c.TH.SET_CURRENT_PAGE,payload:"infrastructure-state"}),t({type:c.TH.REGISTER_PAGE_HANDLER,payload:{page:"infrastructure-state",handler:f}}),()=>{t({type:c.TH.UNREGISTER_PAGE_HANDLER,payload:"infrastructure-state"}),t({type:c.TH.SET_CURRENT_PAGE,payload:null})}),[t,f]),(0,s.useEffect)(()=>{g()},[g]);const h=(()=>{if(!a)return{};let e={};const t=a.resources&&a.resources.length>0,s=a.managed_state?Object.keys(a.managed_state.resources||{}).length:0;a.managed_state&&s>0?e=a.managed_state.resources||{}:t&&(e={},a.resources.forEach((t,a)=>{var s;e[t.id||"resource-".concat(a)]={id:t.id,name:t.name||t.id,type:t.type,status:t.status,properties:{aws_details:t.properties},createdAt:t.createdAt,dependencies:null===(s=t.properties)||void 0===s?void 0:s.dependencies}}));return Object.values(e).filter(e=>"step_reference"!==e.type).filter(e=>!y||e.id.toLowerCase().includes(y.toLowerCase())).reduce((e,t)=>{const a=t.type||"unknown";return e[a]||(e[a]=[]),e[a].push(t),e},{})})(),_=Object.values(h).flat().length;return(0,u.jsxs)("div",{style:{padding:"24px",minHeight:"100vh",backgroundColor:"#fafafa"},children:[(0,u.jsx)(l.l3,{onRefresh:()=>g(!1),refreshing:i,searchTerm:y,onSearchChange:e=>T(e.target.value),totalResources:_,totalCategories:Object.keys(h).length}),e.loading.state?(0,u.jsxs)("div",{style:{textAlign:"center",padding:"80px 0",backgroundColor:"white",borderRadius:"16px",border:"1px solid #e8e8e8"},children:[(0,u.jsx)(r.A,{size:"large"}),(0,u.jsx)("div",{style:{marginTop:24},children:(0,u.jsx)(d,{type:"secondary",style:{fontSize:"16px"},children:"Loading infrastructure resources..."})})]}):(0,u.jsx)(l.Rt,{infrastructureData:a,searchTerm:y})]})}}}]);
//# sourceMappingURL=8660.75ae3728.chunk.js.map